<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Penilaian PPI</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root {
            --primary: #00b894;
            --secondary: #0984e3;
            --bg: #f8fafd;
            --card: #ffffff;
            --text-main: #2d3436;
            --text-sub: #636e72;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg);
            color: var(--text-main);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .form-container {
            background: var(--card);
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            width: 100%;
            max-width: 480px;
            border: 1px solid #eef2f7;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h2 {
            font-size: 1.8rem;
            color: var(--secondary);
            margin: 0;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .header p {
            color: var(--text-sub);
            font-size: 0.95rem;
            margin-top: 8px;
        }

        /* --- Input Styles --- */
        .form-group {
            margin-bottom: 22px;
        }

        .form-group label {
            display: block;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 4px;
        }

        .form-group .desc {
            font-size: 0.8rem;
            color: var(--text-sub);
            margin-bottom: 8px;
            display: block;
            line-height: 1.4;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #eef2f7;
            border-radius: 12px;
            font-family: inherit;
            font-size: 0.95rem;
            background: #fdfdfd;
            transition: 0.3s;
            box-sizing: border-box;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--secondary);
            background: #fff;
        }

        /* --- Rating --- */
        .rating-box {
            background: #f1f7ff;
            padding: 15px;
            border-radius: 16px;
            text-align: center;
        }

        .stars {
            display: flex;
            flex-direction: row-reverse;
            justify-content: center;
        }

        .stars input { display: none; }
        .stars label {
            font-size: 2.2rem;
            color: #d1d8e0;
            cursor: pointer;
            transition: 0.2s;
            padding: 0 4px;
        }

        .stars input:checked ~ label,
        .stars label:hover,
        .stars label:hover ~ label {
            color: #f1c40f;
        }

        /* --- Button --- */
        .btn-kirim {
            background: var(--secondary);
            color: white;
            border: none;
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 10px;
            transition: 0.3s;
        }

        .btn-kirim:hover {
            background: #0771c1;
            box-shadow: 0 8px 20px rgba(9, 132, 227, 0.2);
        }

        /* --- Success Overlay --- */
        #success-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #ffffff;
            display: none;
            flex-direction: column;
            justify-content: center; align-items: center; z-index: 1000;
        }

        .checkmark__circle {
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            stroke-width: 2;
            stroke-miterlimit: 10;
            stroke: var(--primary);
            fill: none;
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }

        .checkmark {
            width: 80px; height: 80px;
            border-radius: 50%;
            display: block;
            stroke-width: 2;
            stroke: var(--primary);
            stroke-miterlimit: 10;
            animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;
        }

        .checkmark__check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
        }

        @keyframes stroke { 100% { stroke-dashoffset: 0; } }
        @keyframes scale { 0%, 100% { transform: none; } 50% { transform: scale3d(1.1, 1.1, 1); } }
        @keyframes fill { 100% { box-shadow: inset 0px 0px 0px 40px transparent; } }

        .progress-container {
            width: 150px; height: 4px;
            background: #eee;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            width: 0%; height: 100%;
            background: var(--primary);
            animation: loading 2s linear forwards;
        }

        @keyframes loading { 100% { width: 100%; } }

        .back-home {
            display: block;
            margin-top: 20px;
            color: var(--text-sub);
            text-decoration: none;
            font-size: 0.85rem;
            text-align: center;
        }
    </style>
</head>
<body>

<div class="form-container">
    <div class="header">
        <h2>Penilaian PPI</h2>
        <p>Berikan masukan Anda untuk evaluasi kami.</p>
    </div>

    <div class="form-group">
        <label>Nama Lengkap</label>
        <span class="desc">Gunakan nama lengkap sesuai identitas.</span>
        <input type="text" id="input-nama" placeholder="Masukkan nama Anda" required>
    </div>

    <div class="form-group">
        <label>Kategori Responden</label>
        <span class="desc">Pilih status Anda dalam organisasi atau masyarakat.</span>
        <select id="input-kategori" onchange="toggleAngkatan()">
            <option value="umum">Masyarakat Umum</option>
            <option value="ppi">Purna Paskibraka (PPI)</option>
        </select>
    </div>

    <div id="group-angkatan" class="form-group" style="display: none;">
        <label>Tahun Angkatan</label>
        <span class="desc">Tahun pelaksanaan tugas Paskibraka.</span>
        <input type="number" id="input-angkatan" placeholder="Contoh: 2024">
    </div>

    <div class="form-group">
        <label>Rating Layanan</label>
        <span class="desc">Skala 1 (Kurang) sampai 5 (Sangat Baik).</span>
        <div class="rating-box">
            <div class="stars">
                <input type="radio" name="rating" value="5" id="s5" checked><label for="s5"><i class="fas fa-star"></i></label>
                <input type="radio" name="rating" value="4" id="s4"><label for="s4"><i class="fas fa-star"></i></label>
                <input type="radio" name="rating" value="3" id="s3"><label for="s3"><i class="fas fa-star"></i></label>
                <input type="radio" name="rating" value="2" id="s2"><label for="s2"><i class="fas fa-star"></i></label>
                <input type="radio" name="rating" value="1" id="s1"><label for="s1"><i class="fas fa-star"></i></label>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label>Pesan & Saran</label>
        <span class="desc">Sampaikan kritik atau apresiasi Anda secara mendetail.</span>
        <textarea id="input-pesan" rows="4" placeholder="Tuliskan di sini..."></textarea>
    </div>

    <button class="btn-kirim" onclick="submitReview()">Kirim Data</button>
    <a href="index.html" class="back-home">Kembali ke Beranda</a>
</div>

<div id="success-overlay">
    <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
        <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
        <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
    </svg>
    <h3 style="margin-top: 15px; margin-bottom: 5px;">Data Terkirim</h3>
    <p style="color: #777; font-size: 0.9rem;">Terima kasih atas partisipasi Anda.</p>
    <div class="progress-container">
        <div class="progress-fill"></div>
    </div>
</div>

<script>
    // --- Konfigurasi Firebase ---
    const firebaseConfig = {
        apiKey: "AIzaSyCtQh5SpZCk2TDUk9iMOjQX5uc6gRIJyp8",
        authDomain: "paskab-c3eb4.firebaseapp.com",
        databaseURL: "https://paskab-c3eb4-default-rtdb.firebaseio.com",
        projectId: "paskab-c3eb4",
        storageBucket: "paskab-c3eb4.firebasestorage.app",
        messagingSenderId: "630872087747",
        appId: "1:630872087747:web:dbe8eee722f2d0f6759676"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function toggleAngkatan() {
        const kat = document.getElementById('input-kategori').value;
        document.getElementById('group-angkatan').style.display = (kat === 'ppi') ? 'block' : 'none';
    }

    function submitReview() {
        const nama = document.getElementById('input-nama').value;
        const rating = document.querySelector('input[name="rating"]:checked').value;
        const pesan = document.getElementById('input-pesan').value;
        const kategori = document.getElementById('input-kategori').value;
        const angkatan = document.getElementById('input-angkatan').value;

        if(!nama || !pesan) {
            alert("Harap lengkapi Nama dan Pesan.");
            return;
        }

        db.ref('penilaian').push({
            nama: nama,
            rating: parseInt(rating),
            pesan: pesan,
            kategori: kategori,
            angkatan: angkatan || "-",
            waktu: new Date().toLocaleString('id-ID')
        }).then(() => {
            document.getElementById('success-overlay').style.display = 'flex';
            setTimeout(() => {
                window.location.href = "index.html";
            }, 2000);
        });
    }
</script>

</body>
</html>
